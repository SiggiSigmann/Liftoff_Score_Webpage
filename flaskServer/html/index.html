<html>
	<head>
		<title>Liftoff Scores</title>
		<link rel="shortcut icon" href="{{ url_for('static', filename='logo.jpg') }}" type="image/x-icon">
		<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='menu.css') }}">
		<!--<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
		<link rel="manifest" href="manifest.webmanifest">-->
	</head>
	<body>
		<!--based on https://www.w3schools.com/howto/tryit.asp?filename=tryhow_js_sidenav-->
		<div id="mysidemenu" class="sidemenu">
			<p>Liftoff Scores</p>
			<a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
			<a href="/" {% if active == "overview" %} id="active"{% endif %}>Overview</a>
			<a href="/users" {% if active == "users" %} id="active"{% endif %}>Users</a>
			<a href="/drone" {% if active == "drones" %} id="active"{% endif %}>Drone</a>
			<a href="/result" {% if active == "results" %} id="active"{% endif %}>Add Time</a>
		</div>
		<script>
			function openNav() {
			document.getElementById("mysidemenu").style.width = "300px";
			}
	
			function closeNav() {
			document.getElementById("mysidemenu").style.width = "0";
			}
		</script>

		
		<h1>Overview</h1>
		<span style="font-size:30px;cursor:pointer" onclick="openNav()">&#9776; Open Menu</span>
		<br>
		<p>Website in progress</p>
		<div id="best"></div>

		<script>
			var tracks = JSON.parse('{{ tracks | tojson | safe}}');
			var users = JSON.parse('{{ users | tojson | safe}}');
			var best_results = JSON.parse('{{ best_results | tojson | safe}}');
			var color = ['rgb(0,255,0)', 'rgb(64,255,0)','rgb(128,255,0)','rgb(192,255,0)','rgb(255,192,0)','rgb(255,128,0)','rgb(255,64,0)','rgb(255,0,0)' ];
			
			var best = document.getElementById("best");
			var tbl = document.createElement('table');
			var tabel = document.createElement('tbody');

			var z1 =  document.createElement('tr');
			var s1 =  document.createElement('th');
			s1.innerHTML = "MAP";
			z1.appendChild(s1);
			var s1 =  document.createElement('th');
			s1.innerHTML = "TRACK";
			z1.appendChild(s1);
			var s1 =  document.createElement('th');
			s1.innerHTML = "HARDNESS";
			z1.appendChild(s1);
			users.forEach (function (user, index) {
				var s1 =  document.createElement('th');
					s1.innerHTML = user[1];
					s1.setAttribute("style","background: "+user[2]+";");
					z1.appendChild(s1);
			});
			tabel.appendChild(z1);
			

			tracks["maps"].forEach (function (map, index) {

				map["tracks"].forEach (function (track, index) {
					var z1 =  document.createElement('tr');
					var s1 =  document.createElement('th');
					s1.innerHTML = map["mapname"];
					z1.appendChild(s1);
					var s1 =  document.createElement('th');
					s1.innerHTML = track["trackname"];
					z1.appendChild(s1);
					var s1 =  document.createElement('th');
					s1.innerHTML = track["hardness"];
					s1.setAttribute("style","background: "+color[track["hardness"]-1]+";");
					z1.appendChild(s1);

					if(best_results.hasOwnProperty(map["mapid"])){
						if(best_results[map["mapid"]].hasOwnProperty(track["trackid"])){
							users.forEach (function (user, index) {
								if(best_results[map["mapid"]][track["trackid"]].hasOwnProperty(user[0])){
									var s1 =  document.createElement('th');
									s1.innerHTML = best_results[map["mapid"]][track["trackid"]][user[0]];
									z1.appendChild(s1);
								}else{
									var s1 =  document.createElement('th');
									z1.appendChild(s1);
								}

							});
						}else{
							users.forEach (function (user, index) {
								var s1 =  document.createElement('th');
								z1.appendChild(s1);
							});
						}
					}
					tabel.appendChild(z1);
				});	
			});	
			
			
			
			tbl.appendChild(tabel);
			best.appendChild(tbl);
			
		</script>

		
	</body>
</html>